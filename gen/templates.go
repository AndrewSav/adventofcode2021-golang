package main

type runDataPart struct {
	Part    int
	Variant string
}

type runDataDay struct {
	Day   int
	Parts []runDataPart
}

type runData struct {
	Days []runDataDay
}

const (
	runTemplate = `// Code generated by 'go run ./gen'; DO NOT EDIT
package main

import (
{{- range $d := .Days }}
	"aoc2021/day{{ printf "%02d" $d.Day }}"
{{- end }}
	"log"
)

type runDataPart struct {
	Part    int
	Variant string
}

type runDataDay struct {
	Day   int
	Parts []runDataPart
}

var days = []runDataDay{
{{- range $d := .Days }}
	{
		Day: {{ $d.Day }},
		Parts: []runDataPart{
{{- range $p := $d.Parts }}
			{
				Part: {{ $p.Part }},
				Variant: "{{ $p.Variant }}",
			},
{{- end}}
		},
	},
{{- end}}
}

func run(day, part int, variant string, inputFile string) (string, int, int, string) {
	switch day {
{{- range $d := .Days }}
	case {{ $d.Day }}:
		switch {
{{- range $p := $d.Parts }}
		case part == {{ $p.Part }} && variant == "{{ $p.Variant }}":
			return day{{ printf "%02d" $d.Day }}.Part{{ $p.Part }}{{ $p.Variant }}(inputFile), day, part, variant
{{- end}}
		default:
			log.Fatalf("Unknown part %d on day %d, variant '%s'", part, day, variant)
		}
{{- end}}
	default:
		log.Fatalf("Unknown  day %d", day)
	}
	panic("unexpected code path")
}
`
)
